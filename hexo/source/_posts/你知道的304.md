---
title: ä½ çŸ¥é“çš„304
date: 2020-04-23 10:48:43
tags:
- ç½‘ç»œ
- webå‰ç«¯
- ç¼“å­˜
categories: "ç½‘ç»œ"
---
ä½ çŸ¥é“çš„304
---
æœåŠ¡å™¨å¸¸è§çš„çŠ¶æ€ç å¾ˆå¤šï¼Œç‰¹åˆ«æ˜¯åœ¨åŽŸç”ŸAjax(XMLHttpRequest)åšå“åº”åˆ¤æ–­çš„çš„æ—¶å€™ä¸èƒ½åªåˆ¤æ–­æ˜¯å¦å°äºŽ300ã€‚è¿˜åº”è¯¥åŠ ä¸Šç­‰äºŽ304ã€‚ä»Šå¤©æ¥æ­å¼€304çš„ç¥žç§˜é¢çº±~

> 304çŠ¶æ€ç ï¼š (Not Modified) å¦‚æžœå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªå¸¦æ¡ä»¶çš„ *GET* è¯·æ±‚ä¸”è¯¥è¯·æ±‚å·²è¢«å…è®¸ï¼Œè€Œæ–‡æ¡£çš„å†…å®¹ï¼ˆè‡ªä¸Šæ¬¡è®¿é—®ä»¥æ¥æˆ–è€…æ ¹æ®è¯·æ±‚çš„æ¡ä»¶ï¼‰å¹¶æ²¡æœ‰æ”¹å˜ï¼Œåˆ™æœåŠ¡å™¨åº”å½“è¿”å›žè¿™ä¸ª304çŠ¶æ€ç ã€‚ç®€å•çš„è¡¨è¾¾å°±æ˜¯ï¼šæœåŠ¡ç«¯å·²ç»æ‰§è¡Œäº†GETï¼Œä½†æ–‡ä»¶æœªå˜åŒ–ã€‚

ä¸Šé¢æ˜¯[ç™¾åº¦ç™¾ç§‘](https://baike.baidu.com/item/304%E7%8A%B6%E6%80%81%E7%A0%81/7867141?fr=aladdin)çš„è§£é‡ŠðŸ‘†ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå½“æˆ‘ä»¬ç¬¬äºŒæ¬¡è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ä¼šæ ¹æ®ç¼“å­˜çš„*ç›¸åº”æ¡ä»¶*è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æžœå¾—å‡ºæœåŠ¡å™¨çš„æ–‡ä»¶æ²¡æœ‰æ”¹å˜ï¼Œé‚£ä¹ˆå°±è¿”å›ž304çŠ¶æ€ç ~


ä¸‹é¢æˆ‘ä»¬å…·ä½“è¯´è¯´304ç¼“å­˜
---

304ç¼“å­˜åˆ†ä¸º*å¼ºç¼“å­˜*ä¸Ž*åå•†ç¼“å­˜*

#### å¼ºç¼“å­˜

æˆ‘ä»¬ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨åŽæœåŠ¡å™¨è¿”å›žçš„å“åº”å¤´å†…å¯èƒ½åŒ…å«Cache-Controlã€Expireså­—æ®µï¼Œè¿™ä¸¤ä¸ªå­—æ®µå¯¹åº”çš„å°±æ˜¯å¼ºç¼“å­˜ðŸ‘‡


![](https://imgkr.cn-bj.ufileos.com/08353796-cab4-45bf-9ff4-79a61ad35c68.png)


åœ¨**HTTP1.0**çš„æ—¶å€™åªæœ‰Expiresï¼Œå®ƒæ˜¯ä¸€ä¸ª*ç»å¯¹æ—¶é—´*ï¼Œä»£è¡¨ç€HTTPç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼Œå› ä¸ºæœåŠ¡å™¨æ—¶é—´ä¸Žæœ¬åœ°å¯èƒ½å­˜åœ¨ä¸åŒï¼Œæ‰€ä»¥ä¼šå½±å“åˆ°å¼ºç¼“å­˜çš„å‘½ä¸­ã€‚

æ‰€ä»¥åœ¨**HTTP1.1**çš„æ—¶å€™åŠ å…¥äº†Cache-Controlï¼Œå®ƒæ˜¯ä¸€ä¸ªç›¸å¯¹æ—¶é—´ï¼Œå¸¸ç”¨çš„å€¼ä¸ºðŸ‘‡
|å€¼|è¯´æ˜Ž|
|:-:|:-:|
|public|å…¶ä»–ç”¨æˆ·ä¹Ÿå¯ä»¥ä½¿ç”¨ç¼“å­˜èµ„æº|
|private|ç¼“å­˜æœåŠ¡å™¨åªç»™æŒ‡å®šçš„ç”¨æˆ·è¿”å›žç¼“å­˜èµ„æºï¼Œå¯¹äºŽå…¶ä»–ç”¨æˆ·ä¸è¿”å›žç¼“å­˜èµ„æº|
|max-age|å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œæ­¤èµ„æºåœ¨å¤šä¹…ä¹‹å†…æ˜¯æœªæ”¹å˜çš„ï¼Œæ— éœ€å‘æœåŠ¡å™¨å‘é€è¯·æ±‚|
|s-maxage|ä¸Žmax-ageç±»ä¼¼ï¼Œåªä¸è¿‡åªèƒ½ç”¨äºŽå…±äº«ç¼“å­˜|
|no-cache|ä¸ç›´æŽ¥ä½¿ç”¨ç¼“å­˜ï¼Œéœ€è¦å‘æœåŠ¡å™¨å‘é€è¯·æ±‚|
|no-store|æ‰€æœ‰å†…å®¹ä¸è¿›è¡Œç¼“å­˜|
|must-revalidate|å½“å‰èµ„æºä¸€å®šä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè‹¥è¯·æ±‚å¤±è´¥ä¼šè¿”å›ž504ç½‘å…³è¶…æ—¶|
|proxy-revalidate|ä¸Žmust-revalidateç±»ä¼¼ï¼Œåªä¸è¿‡åªèƒ½ä½¿ç”¨å…±äº«ç¼“å­˜|

å½“å¼ºç¼“å­˜å‘½ä¸­æ—¶ï¼Œä¸éœ€è¦ä¸ŽæœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œç›´æŽ¥ä½¿ç”¨ç¼“å­˜èµ„æº

è‹¥æœªå‘½ä¸­ï¼Œåˆ™è¿›è¡Œä¸‹ä¸€æ­¥**åå•†ç¼“å­˜**

#### åå•†ç¼“å­˜
å½“å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¿›è¡Œè¯·æ±‚çš„æ—¶å€™å“åº”å¤´ä¸ä½†ä¼šåŒ…å«Cache-Controlã€Expiresè¿™äº›å¼ºç¼“å­˜å­—æ ·ï¼Œè€Œä¸”è¿˜ä¼šåŒ…å«åƒLast-Modifiedæˆ–ETag

![](https://imgkr.cn-bj.ufileos.com/08c96608-4c30-475a-b2c1-bac89afbc716.png)
Last-Modifiedé¡¾åæ€ä¹‰ï¼Œæ˜¯ä¸Šä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´ã€‚
å½“æˆ‘ä»¬ç¬¬äºŒæ¬¡å‘é€è¯·æ±‚çš„æ—¶å€™å¦‚æžœå¼ºç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œå‘æœåŠ¡å™¨å‘é€çš„è¯·æ±‚å¤´ä¸­ä¼šæºå¸¦If-Modified-Sinceå­—æ®µï¼Œå®ƒçš„å€¼ä¸ºç¬¬ä¸€æ¬¡æœåŠ¡å™¨è¿”å›žç»™æˆ‘ä»¬çš„Last-Modifiedçš„å€¼ã€‚å¦‚æžœè¿™ä¸¤ä¸ªå€¼ç›¸ç­‰è¯´æ˜Žè¯¥èµ„æºæ²¡æœ‰è¿›è¡Œä¿®æ”¹ï¼Œåˆ™è¿”å›ž**çŠ¶æ€ç 304**ï¼Œå¦åˆ™è¿”å›ž**çŠ¶æ€ç 200**ï¼Œå¹¶å°†æ–°èµ„æºå‘é€ç»™å®¢æˆ·ç«¯ã€‚

è€ŒETagæ˜¯æœåŠ¡ç«¯çš„ä¸€ä¸ªèµ„æºçš„æ ‡è¯†ï¼Œå®ƒä»£è¡¨ç€è¯¥èµ„æºçš„å”¯ä¸€æ€§ï¼Œæ¯å½“è¯¥èµ„æºè¿›è¡Œä¿®æ”¹çš„æ—¶å€™ï¼Œå€¼éƒ½ä¼šåšå‡ºç›¸åº”çš„æ”¹å˜ã€‚åŒLast-Modifiedç±»ä¼¼ï¼Œç¬¬ä¸€æ¬¡è¿›è¡Œè¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ä¼šè¿”å›žETagå­—æ®µï¼Œå½“å¼ºç¼“å­˜æ²¡æœ‰å‘½ä¸­çš„æ—¶å€™ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚ä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦If-None-Matchå­—æ®µï¼Œå®ƒçš„å€¼ä¸ŽETagçš„å€¼ä¸€è‡³ï¼Œä»¥æ­¤æ¥åˆ¤æ–­è¯¥èµ„æºæ˜¯å¦è¢«ä¿®æ”¹ï¼Œå¦‚æžœæœªè¢«ä¿®æ”¹ï¼Œè¿”å›ž**çŠ¶æ€ç 304**ï¼Œå¦åˆ™è¿”å›ž**çŠ¶æ€ç 200**ï¼Œå¹¶å°†æ–°èµ„æºè¿”å›žç»™å®¢æˆ·ç«¯ã€‚

åŒæ ·çš„åœ¨HTTP1.0çš„æ—¶å€™Last-Modifiedçš„å€¼æ˜¯ä¸€ä¸ªç»å¯¹æ—¶é—´ï¼Œä¼šå½±å“ç¼“å­˜å‘½ä¸­ï¼Œæ‰€ä»¥åœ¨HTTP1.1çš„æ—¶å€™æå‡ºäº†ETagã€‚

#### ç¼“å­˜ä¼˜å…ˆçº§

*å¼ºç¼“å­˜*åœ¨å‰*åå•†ç¼“å­˜*åœ¨åŽ
å¦‚æžœç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶å€™ï¼Œå“åº”å¤´è¿”å›žçš„å­—æ®µä¸­æ—¢åŒ…å«**Cache-Control**å’Œ**Expires**

å¼ºç¼“å­˜ä¸­ `Cache-Control > Expires`

åº”å¤´è¿”å›žçš„å­—æ®µä¸­æ—¢åŒ…å«**ETag**å’Œ**Last-Modified**

åå•†ç¼“å­˜ä¸­ `ETag > Last-Modified`